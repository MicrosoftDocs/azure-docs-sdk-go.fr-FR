---
title: Authentification avec le Kit de développement logiciel (SDK) Azure pour Go
description: En savoir plus sur les méthodes d’authentification disponibles dans le Kit de développement logiciel (SDK) Azure pour Go et comment les utiliser.
services: azure
author: sptramer
ms.author: sttramer
manager: carmonm
ms.date: 09/05/2018
ms.topic: conceptual
ms.technology: azure-sdk-go
ms.devlang: go
ms.service: active-directory
ms.component: authentication
ms.openlocfilehash: 28fd4a4c0832ab19dcf52dc549d0ddc0d1eec6f1
ms.sourcegitcommit: 8b9e10b960150dc08f046ab840d6a5627410db29
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/07/2018
ms.locfileid: "44059099"
---
# <a name="authentication-methods-in-the-azure-sdk-for-go"></a><span data-ttu-id="ccb27-103">Méthodes d’authentification dans le Kit de développement logiciel (SDK) Azure pour Go</span><span class="sxs-lookup"><span data-stu-id="ccb27-103">Authentication methods in the Azure SDK for Go</span></span>

<span data-ttu-id="ccb27-104">Azure SDK pour Go propose plusieurs modes d’authentification avec Azure.</span><span class="sxs-lookup"><span data-stu-id="ccb27-104">The Azure SDK for Go offers multiple ways to authenticate with Azure.</span></span> <span data-ttu-id="ccb27-105">Ces _types_ d’authentification sont appelés grâce à différentes _méthodes_ d’authentification.</span><span class="sxs-lookup"><span data-stu-id="ccb27-105">These authentication _types_ are invoked through different authentication _methods_.</span></span> <span data-ttu-id="ccb27-106">Cet article aborde les types et méthodes d’authentification disponibles, et vous aide à déterminer celles adaptées pour votre application.</span><span class="sxs-lookup"><span data-stu-id="ccb27-106">This article covers the available types, methods, and how to choose which are best for your application.</span></span>

## <a name="available-authentication-types-and-methods"></a><span data-ttu-id="ccb27-107">Méthodes et types d’authentification disponibles</span><span class="sxs-lookup"><span data-stu-id="ccb27-107">Available authentication types and methods</span></span>

<span data-ttu-id="ccb27-108">Le Kit de développement logiciel (SDK) Azure pour Go offre différents types d’authentification, utilisant des informations d’identification différentes.</span><span class="sxs-lookup"><span data-stu-id="ccb27-108">The Azure SDK for Go offers several different types of authentication, using different credentials sets.</span></span> <span data-ttu-id="ccb27-109">Chaque type d’authentification est disponible via différentes méthodes d’authentification, qui correspondent à la façon dont le Kit de développement logiciel (SDK) accepte ces informations d’identification en tant qu’entrées.</span><span class="sxs-lookup"><span data-stu-id="ccb27-109">Each authentication type is available through different authentication methods, which are how the SDK takes these credentials as input.</span></span> <span data-ttu-id="ccb27-110">Le tableau suivant décrit les types d’authentification disponibles et les situations dans lesquelles leur utilisation est recommandée pour votre application.</span><span class="sxs-lookup"><span data-stu-id="ccb27-110">The following table describes the available types of authentication and situations in which they're recommended for use by your application.</span></span>

| <span data-ttu-id="ccb27-111">Type d'authentification</span><span class="sxs-lookup"><span data-stu-id="ccb27-111">Authentication type</span></span> | <span data-ttu-id="ccb27-112">Recommandé lorsque...</span><span class="sxs-lookup"><span data-stu-id="ccb27-112">Recommended when...</span></span> |
|---------------------|---------------------|
| <span data-ttu-id="ccb27-113">Authentification par certificat</span><span class="sxs-lookup"><span data-stu-id="ccb27-113">Certificate-based authentication</span></span> | <span data-ttu-id="ccb27-114">Vous avez un certificat X509 qui a été configuré pour un utilisateur ou un principal de service Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="ccb27-114">You have an X509 certificate that was configured for an Azure Active Directory (AAD) user or service principal.</span></span> <span data-ttu-id="ccb27-115">Pour en savoir plus, consultez [Bien démarrer avec l’authentification par certificat dans Azure Active Directory].</span><span class="sxs-lookup"><span data-stu-id="ccb27-115">To learn more, see [Get started with certificate-based authentication in Azure Active Directory].</span></span> |
| <span data-ttu-id="ccb27-116">Informations d'identification du client</span><span class="sxs-lookup"><span data-stu-id="ccb27-116">Client credentials</span></span> | <span data-ttu-id="ccb27-117">Vous avez un principal de service configuré pour cette application ou pour la classe d’applications à laquelle elle appartient.</span><span class="sxs-lookup"><span data-stu-id="ccb27-117">You have a configured service principal that is set up for this application or a class of applications it belongs to.</span></span> <span data-ttu-id="ccb27-118">Pour en savoir plus, consultez [Créer un principal de service avec l’interface de ligne de commande Azure 2.0].</span><span class="sxs-lookup"><span data-stu-id="ccb27-118">To learn more, see [Create a service principal with Azure CLI].</span></span> |
| <span data-ttu-id="ccb27-119">Identité du service administré (MSI)</span><span class="sxs-lookup"><span data-stu-id="ccb27-119">Managed Service Identity (MSI)</span></span> | <span data-ttu-id="ccb27-120">Votre application s’exécute sur une ressource Azure qui a été configurée avec Identité du service administré (MSI).</span><span class="sxs-lookup"><span data-stu-id="ccb27-120">Your application is running on an Azure resource that has been configured with Managed Service Identity (MSI).</span></span> <span data-ttu-id="ccb27-121">Pour en savoir plus, consultez [Identité du service administré (MSI) pour les ressources Azure].</span><span class="sxs-lookup"><span data-stu-id="ccb27-121">To learn more, see [Managed Service Identity (MSI) for Azure resources].</span></span> |
| <span data-ttu-id="ccb27-122">Jeton d’appareil</span><span class="sxs-lookup"><span data-stu-id="ccb27-122">Device token</span></span> | <span data-ttu-id="ccb27-123">Votre application est destinée à être utilisée de manière interactive __uniquement__.</span><span class="sxs-lookup"><span data-stu-id="ccb27-123">Your application is meant to be used interactively __only__.</span></span> <span data-ttu-id="ccb27-124">Les utilisateurs peuvent avoir l’authentification multifacteur activée.</span><span class="sxs-lookup"><span data-stu-id="ccb27-124">Users may have multi-factor authentication enabled.</span></span> <span data-ttu-id="ccb27-125">Les utilisateurs ont accès à un navigateur web pour se connecter.</span><span class="sxs-lookup"><span data-stu-id="ccb27-125">Users have access to a web browser to sign in.</span></span> <span data-ttu-id="ccb27-126">Pour plus d’informations, consultez [Utilisation de l’authentification par jeton d’appareil](#use-device-token-authentication).</span><span class="sxs-lookup"><span data-stu-id="ccb27-126">For more information, see [Use device token authentication](#use-device-token-authentication).</span></span>|
| <span data-ttu-id="ccb27-127">Nom d’utilisateur/mot de passe</span><span class="sxs-lookup"><span data-stu-id="ccb27-127">Username/password</span></span> | <span data-ttu-id="ccb27-128">Vous avez une application interactive qui ne peut pas utiliser d’autres méthodes d’authentification.</span><span class="sxs-lookup"><span data-stu-id="ccb27-128">You have an interactive application that can't use any other authentication method.</span></span> <span data-ttu-id="ccb27-129">L’authentification multifacteur n’est pas activée pour la connexion AAD de vos utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ccb27-129">Your users don't have multi-factor authentication enabled for their AAD sign-in.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="ccb27-130">Si vous utilisez un type d’authentification autre que les informations d’identification du client, votre application doit être inscrite dans Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ccb27-130">If you use an authentication type other than client credentials, your application must be registered in Azure Active Directory.</span></span> <span data-ttu-id="ccb27-131">Pour en savoir plus, consultez [Intégration d’applications dans Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span><span class="sxs-lookup"><span data-stu-id="ccb27-131">To learn how, see [Integrating applications with Azure Active Directory](/azure/active-directory/develop/active-directory-integrating-applications).</span></span>
>
> [!NOTE]
> <span data-ttu-id="ccb27-132">Évitez l’authentification par nom d’utilisateur/mot de passe, à moins que vous n’ayez des exigences particulières.</span><span class="sxs-lookup"><span data-stu-id="ccb27-132">Unless you have special requirements, avoid username/password authentication.</span></span> <span data-ttu-id="ccb27-133">Dans les situations où la connexion basée sur l’utilisateur est nécessaire, l’authentification par jeton d’appareil peut en général être utilisée à la place.</span><span class="sxs-lookup"><span data-stu-id="ccb27-133">In situations where user-based sign in is appropriate, device token authentication can usually be used instead.</span></span>

[Bien démarrer avec l’authentification par certificat dans Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Get started with certificate-based authentication in Azure Active Directory]: /azure/active-directory/active-directory-certificate-based-authentication-get-started
[Créer un principal de service avec l’interface de ligne de commande Azure 2.0]: /cli/azure/create-an-azure-service-principal-azure-cli
[Create a service principal with Azure CLI]: /cli/azure/create-an-azure-service-principal-azure-cli
[Identité du service administré (MSI) pour les ressources Azure]: /azure/active-directory/managed-service-identity/overview
[Managed Service Identity (MSI) for Azure resources]: /azure/active-directory/managed-service-identity/overview

<span data-ttu-id="ccb27-137">Ces types d’authentification sont disponibles par le biais de différentes méthodes.</span><span class="sxs-lookup"><span data-stu-id="ccb27-137">These authentication types are available through different methods.</span></span>

* <span data-ttu-id="ccb27-138">[_L’authentification basée sur l’environnement_](#use-environment-based-authentication) lit les informations d’identification directement à partir de l’environnement du programme.</span><span class="sxs-lookup"><span data-stu-id="ccb27-138">[_Environment-based authentication_](#use-environment-based-authentication) reads credentials directly from the program's environment.</span></span>
* <span data-ttu-id="ccb27-139">[_L’authentification basée sur un fichier_](#use-file-based-authentication) charge un fichier contenant les informations d’identification du principal de service.</span><span class="sxs-lookup"><span data-stu-id="ccb27-139">[_File-based authentication_](#use-file-based-authentication) loads a file containing service principal credentials.</span></span>
* <span data-ttu-id="ccb27-140">[_L’authentification basée sur le client_](#use-an-authentication-client) utilise un objet dans le code et vous charge de fournir les informations d’identification lors de l’exécution du programme.</span><span class="sxs-lookup"><span data-stu-id="ccb27-140">[_Client-based authentication_](#use-an-authentication-client) uses an object in code and makes you responsible for providing the credentials during program execution.</span></span>
* <span data-ttu-id="ccb27-141">[_L’authentification par jeton d’appareil_](#use-device-token-authentication) nécessite que les utilisateurs se connectent de manière interactive via un navigateur web avec un jeton.</span><span class="sxs-lookup"><span data-stu-id="ccb27-141">[_Device token authentication_](#use-device-token-authentication) requires users to sign in interactively through a web browser with a token.</span></span>

<span data-ttu-id="ccb27-142">Tous les types et fonctions d’authentification sont disponibles dans le package `github.com/Azure/go-autorest/autorest/azure/auth`.</span><span class="sxs-lookup"><span data-stu-id="ccb27-142">All authentication functions and types are available in the `github.com/Azure/go-autorest/autorest/azure/auth` package.</span></span>

> [!NOTE]
> <span data-ttu-id="ccb27-143">Évitez l’authentification basée sur le client, à moins que vous n’ayez des exigences particulières.</span><span class="sxs-lookup"><span data-stu-id="ccb27-143">Unless you have special requirements, avoid client-based authentication.</span></span> <span data-ttu-id="ccb27-144">Cette méthode d’authentification favorise les mauvaises pratiques.</span><span class="sxs-lookup"><span data-stu-id="ccb27-144">This method of authentication encourages bad practices.</span></span> <span data-ttu-id="ccb27-145">En utilisant l’authentification basée sur le client en particulier, il devient tentant de coder en dur les informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="ccb27-145">In particular, using client-based authentication makes it tempting to hard-code credentials.</span></span> <span data-ttu-id="ccb27-146">L’écriture d’un code personnalisé pour l’authentification pourrait aussi s’interrompre sous les versions ultérieures du Kit de développement logiciel (SDK) si les exigences d’authentification sont modifiées.</span><span class="sxs-lookup"><span data-stu-id="ccb27-146">Writing custom code for authentication may also break under future SDK releases if authentication requirements change.</span></span>

## <a name="use-environment-based-authentication"></a><span data-ttu-id="ccb27-147">Utiliser l’authentification basée sur l’environnement</span><span class="sxs-lookup"><span data-stu-id="ccb27-147">Use environment-based authentication</span></span>

<span data-ttu-id="ccb27-148">Si vous exécutez votre application dans un environnement contrôlé, l’authentification basée sur l’environnement est un choix évident.</span><span class="sxs-lookup"><span data-stu-id="ccb27-148">If you're running your application in a controlled setting, environment-based authentication is a natural choice.</span></span> <span data-ttu-id="ccb27-149">Cette méthode d’authentification vous permet de configurer l’environnement de l’interpréteur de commandes avant l’exécution de votre application.</span><span class="sxs-lookup"><span data-stu-id="ccb27-149">With this authentication method, you configure the shell environment before running your application.</span></span> <span data-ttu-id="ccb27-150">Lors de l’exécution, le Kit de développement logiciel (SDK) Go lit ces variables d’environnement pour s’authentifier auprès d’Azure.</span><span class="sxs-lookup"><span data-stu-id="ccb27-150">At runtime, the Go SDK reads these environment variables to authenticate with Azure.</span></span>

<span data-ttu-id="ccb27-151">L’authentification basée sur l’environnement prend en charge toutes les méthodes d’authentification, à l’exception des jetons d’appareil, évaluées dans l’ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="ccb27-151">Environment-based authentication has support for all authentication methods except device tokens, evaluated in the following order:</span></span>

* <span data-ttu-id="ccb27-152">Informations d'identification du client</span><span class="sxs-lookup"><span data-stu-id="ccb27-152">Client credentials</span></span>
* <span data-ttu-id="ccb27-153">Certificats X509</span><span class="sxs-lookup"><span data-stu-id="ccb27-153">X509 certificates</span></span>
* <span data-ttu-id="ccb27-154">Nom d’utilisateur/mot de passe</span><span class="sxs-lookup"><span data-stu-id="ccb27-154">Username/password</span></span>
* <span data-ttu-id="ccb27-155">Identité du service administré (MSI)</span><span class="sxs-lookup"><span data-stu-id="ccb27-155">Managed Service Identity (MSI)</span></span>

<span data-ttu-id="ccb27-156">Si les valeurs d’un type d’authentification sont annulées ou s’il est refusé, le Kit de développement logiciel (SDK) essaie automatiquement d’utiliser le type d’authentification suivant.</span><span class="sxs-lookup"><span data-stu-id="ccb27-156">If an authentication type has unset values or is refused, the SDK automatically tries the next authentication type.</span></span> <span data-ttu-id="ccb27-157">Quand tous les autres types d’authentification disponibles ont été testés, le Kit de développement logiciel (SDK) renvoie une erreur.</span><span class="sxs-lookup"><span data-stu-id="ccb27-157">When no more types are available to try, the SDK returns an error.</span></span>

<span data-ttu-id="ccb27-158">Le tableau suivant répertorie les variables d’environnement qui doivent être définies pour chaque type d’authentification pris en charge par l’authentification basée sur l’environnement.</span><span class="sxs-lookup"><span data-stu-id="ccb27-158">The following table details the environment variables that need to be set for each authentication type supported by environment-based authentication.</span></span>

| <span data-ttu-id="ccb27-159">Type d'authentification</span><span class="sxs-lookup"><span data-stu-id="ccb27-159">Authentication type</span></span> | <span data-ttu-id="ccb27-160">Variable d’environnement</span><span class="sxs-lookup"><span data-stu-id="ccb27-160">Environment variable</span></span> | <span data-ttu-id="ccb27-161">Description</span><span class="sxs-lookup"><span data-stu-id="ccb27-161">Description</span></span> |
| ------------------- | -------------------- | ----------- |
| <span data-ttu-id="ccb27-162">__Informations d’identification du client__</span><span class="sxs-lookup"><span data-stu-id="ccb27-162">__Client credentials__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="ccb27-163">L’ID du locataire Active Directory auquel appartient le principal du service.</span><span class="sxs-lookup"><span data-stu-id="ccb27-163">The ID for the Active Directory tenant that the service principal belongs to.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="ccb27-164">Le nom ou ID du principal du service.</span><span class="sxs-lookup"><span data-stu-id="ccb27-164">The name or ID of the service principal.</span></span> |
| | `AZURE_CLIENT_SECRET` | <span data-ttu-id="ccb27-165">Secret associé au principal du service.</span><span class="sxs-lookup"><span data-stu-id="ccb27-165">The secret associated with the service principal.</span></span> |
| <span data-ttu-id="ccb27-166">__Certificate__</span><span class="sxs-lookup"><span data-stu-id="ccb27-166">__Certificate__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="ccb27-167">L’ID du locataire Active Directory avec lequel le certificat est enregistré.</span><span class="sxs-lookup"><span data-stu-id="ccb27-167">The ID for the Active Directory tenant that the certificate is registered with.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="ccb27-168">L’ID client d’application associé au certificat.</span><span class="sxs-lookup"><span data-stu-id="ccb27-168">The application client ID associated with the certificate.</span></span> |
| | `AZURE_CERTIFICATE_PATH` | <span data-ttu-id="ccb27-169">Le chemin d’accès au fichier de certificat client.</span><span class="sxs-lookup"><span data-stu-id="ccb27-169">The path to the client certificate file.</span></span> |
| | `AZURE_CERTIFICATE_PASSWORD` | <span data-ttu-id="ccb27-170">Le mot de passe du certificat client.</span><span class="sxs-lookup"><span data-stu-id="ccb27-170">The password for the client certificate.</span></span> |
| <span data-ttu-id="ccb27-171">__Nom d’utilisateur/mot de passe__</span><span class="sxs-lookup"><span data-stu-id="ccb27-171">__Username/Password__</span></span> | `AZURE_TENANT_ID` | <span data-ttu-id="ccb27-172">L’ID du locataire Active Directory auquel appartient l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ccb27-172">The ID for the Active Directory tenant that the user belongs to.</span></span> |
| | `AZURE_CLIENT_ID` | <span data-ttu-id="ccb27-173">L’ID du client d’application.</span><span class="sxs-lookup"><span data-stu-id="ccb27-173">The application client ID.</span></span> |
| | `AZURE_USERNAME` | <span data-ttu-id="ccb27-174">Le nom d’utilisateur avec lequel se connecter.</span><span class="sxs-lookup"><span data-stu-id="ccb27-174">The username to sign in with.</span></span> |
| | `AZURE_PASSWORD` | <span data-ttu-id="ccb27-175">Le mot de passe avec lequel se connecter.</span><span class="sxs-lookup"><span data-stu-id="ccb27-175">The password to sign in with.</span></span> |
| <span data-ttu-id="ccb27-176">__MSI__</span><span class="sxs-lookup"><span data-stu-id="ccb27-176">__MSI__</span></span> | | <span data-ttu-id="ccb27-177">Aucune information d’identification n’est nécessaire pour l’authentification MSI.</span><span class="sxs-lookup"><span data-stu-id="ccb27-177">No credentials are needed for MSI authentication.</span></span> <span data-ttu-id="ccb27-178">L’application doit être exécutée sur une ressource Azure configurée pour utiliser MSI.</span><span class="sxs-lookup"><span data-stu-id="ccb27-178">The application must be running on an Azure resource configured to use MSI.</span></span> <span data-ttu-id="ccb27-179">Pour plus de détails, consultez [Identité du service administré (MSI) pour les ressources Azure].</span><span class="sxs-lookup"><span data-stu-id="ccb27-179">For details, see [Managed Service Identity (MSI) for Azure resources].</span></span> |

<span data-ttu-id="ccb27-180">Pour vous connecter à un point de terminaison cloud ou de gestion autre que le cloud public Azure par défaut, définissez les variables d’environnement suivantes.</span><span class="sxs-lookup"><span data-stu-id="ccb27-180">To connect to a cloud or management endpoint other than the default Azure public cloud, set the following environment variables.</span></span> <span data-ttu-id="ccb27-181">Voici les raisons les plus courantes pour lesquelles vous devez les définir : si vous utilisez Azure Stack, un cloud dans une autre région géographique ou le modèle de déploiement classique.</span><span class="sxs-lookup"><span data-stu-id="ccb27-181">The most common reasons are if you use Azure Stack, a cloud in a different geographic region, or the classic deployment model.</span></span>

| <span data-ttu-id="ccb27-182">Variable d’environnement</span><span class="sxs-lookup"><span data-stu-id="ccb27-182">Environment variable</span></span> | <span data-ttu-id="ccb27-183">Description</span><span class="sxs-lookup"><span data-stu-id="ccb27-183">Description</span></span>  |
|----------------------|--------------|
| `AZURE_ENVIRONMENT` | <span data-ttu-id="ccb27-184">Le nom de l’environnement de cloud auquel se connecter.</span><span class="sxs-lookup"><span data-stu-id="ccb27-184">The name of the cloud environment to connect to.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="ccb27-185">L’ID de ressource Active Directory à utiliser pour vous connecter, comme une URI, à votre point de terminaison de gestion.</span><span class="sxs-lookup"><span data-stu-id="ccb27-185">The Active Directory resource ID to use when connecting, as a URI to your management endpoint.</span></span> |

<span data-ttu-id="ccb27-186">Lorsque vous utilisez l’authentification basée sur l’environnement, appelez la fonction [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment)afin d’obtenir votre objet d’agent d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="ccb27-186">When using environment-based authentication, call the [NewAuthorizerFromEnvironment](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromEnvironment) function to get your authorizer object.</span></span> <span data-ttu-id="ccb27-187">Cet objet est ensuite défini sur la propriété `Authorizer` des clients pour leur permettre d’accéder à Azure.</span><span class="sxs-lookup"><span data-stu-id="ccb27-187">This object is then set on the `Authorizer` property of clients to allow them access to Azure.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := auth.NewAuthorizerFromEnvironment()
```

### <a name="authentication-on-azure-stack"></a><span data-ttu-id="ccb27-188">Authentification sur Azure Stack</span><span class="sxs-lookup"><span data-stu-id="ccb27-188">Authentication on Azure Stack</span></span>

<span data-ttu-id="ccb27-189">Pour s’authentifier sur Azure Stack, vous devez définir les variables suivantes :</span><span class="sxs-lookup"><span data-stu-id="ccb27-189">To authenticate on Azure Stack, you need to set the following variables:</span></span>

| <span data-ttu-id="ccb27-190">Variable d’environnement</span><span class="sxs-lookup"><span data-stu-id="ccb27-190">Environment variable</span></span> | <span data-ttu-id="ccb27-191">Description</span><span class="sxs-lookup"><span data-stu-id="ccb27-191">Description</span></span>  |
|----------------------|--------------|
| `AZURE_AD_ENDPOINT` | <span data-ttu-id="ccb27-192">Le point de terminaison Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ccb27-192">The Active Directory endpoint.</span></span> |
| `AZURE_AD_RESOURCE` | <span data-ttu-id="ccb27-193">L’ID de ressource Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ccb27-193">The Active Directory resource ID.</span></span> |

<span data-ttu-id="ccb27-194">Ces variables peuvent être récupérés à partir des informations de métadonnées Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="ccb27-194">These variables can be retrieved from Azure Stack metadata information.</span></span> <span data-ttu-id="ccb27-195">Pour récupérer les métadonnées, ouvrez un navigateur web dans votre environnement Azure Stack et utilisez l’url : `(ResourceManagerURL)/metadata/endpoints?api-version=1.0`</span><span class="sxs-lookup"><span data-stu-id="ccb27-195">To retrieve the metadata, open a web browser in your Azure Stack environment and use the url: `(ResourceManagerURL)/metadata/endpoints?api-version=1.0`</span></span>

<span data-ttu-id="ccb27-196">L’élément `ResourceManagerURL` dépend du nom de la région, du nom de la machine, ainsi que du nom de domaine complet (FQDN) externe de votre déploiement Azure Stack :</span><span class="sxs-lookup"><span data-stu-id="ccb27-196">The `ResourceManagerURL` varies based on the region name, machine name, and external fully qualified domain name (FQDN) of your Azure Stack deployment:</span></span>

| <span data-ttu-id="ccb27-197">Environnement</span><span class="sxs-lookup"><span data-stu-id="ccb27-197">Environment</span></span> | <span data-ttu-id="ccb27-198">ResourceManagerURL</span><span class="sxs-lookup"><span data-stu-id="ccb27-198">ResourceManagerURL</span></span> |
|----------------------|--------------|
| <span data-ttu-id="ccb27-199">Kit de développement</span><span class="sxs-lookup"><span data-stu-id="ccb27-199">Development Kit</span></span> | `https://management.local.azurestack.external/` |
| <span data-ttu-id="ccb27-200">Systèmes intégrés</span><span class="sxs-lookup"><span data-stu-id="ccb27-200">Integrated Systems</span></span> | `https://management.(region).ext-(machine-name).(FQDN)` |

<span data-ttu-id="ccb27-201">Pour plus d’informations sur l’utilisation d’Azure SDK pour Go sur Azure Stack, consultez [Utilisez des profils de version des API avec Go dans Azure Stack](https://docs.microsoft.com/azure/azure-stack/user/azure-stack-version-profiles-go)</span><span class="sxs-lookup"><span data-stu-id="ccb27-201">For more information on how to use the Azure SDK for Go on Azure Stack, see [Use API version profiles with Go in Azure Stack](https://docs.microsoft.com/azure/azure-stack/user/azure-stack-version-profiles-go)</span></span>

## <a name="use-file-based-authentication"></a><span data-ttu-id="ccb27-202">Utiliser l’authentification basée sur un fichier</span><span class="sxs-lookup"><span data-stu-id="ccb27-202">Use file-based authentication</span></span>

<span data-ttu-id="ccb27-203">L’authentification basée sur un fichier utilise un format de fichier généré par [Azure CLI](/cli/azure).</span><span class="sxs-lookup"><span data-stu-id="ccb27-203">File-based authentication uses a file format generated by [the Azure CLI](/cli/azure).</span></span> <span data-ttu-id="ccb27-204">Vous pouvez facilement créer ce fichier lors de la création d’un principal de service avec le paramètre `--sdk-auth`.</span><span class="sxs-lookup"><span data-stu-id="ccb27-204">You can easily create this file when creating a new service principal with the `--sdk-auth` parameter.</span></span> <span data-ttu-id="ccb27-205">Si vous prévoyez d’utiliser l’authentification basée sur un fichier, assurez-vous que cet argument est fourni lors de la création d’un principal de service.</span><span class="sxs-lookup"><span data-stu-id="ccb27-205">If you plan on using file-based authentication, make sure that this argument is provided when creating a service principal.</span></span> <span data-ttu-id="ccb27-206">Étant donné que l’interface CLI imprime la sortie vers `stdout`, redirigez la sortie vers un fichier.</span><span class="sxs-lookup"><span data-stu-id="ccb27-206">Since the CLI prints output to `stdout`, redirect output to a file.</span></span>

```azurecli
az ad sp create-for-rbac --sdk-auth > azure.auth
```

<span data-ttu-id="ccb27-207">Définissez la variable d’environnement `AZURE_AUTH_LOCATION` dans laquelle se trouve le fichier d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="ccb27-207">Set the `AZURE_AUTH_LOCATION` environment variable to where the authorization file is located.</span></span> <span data-ttu-id="ccb27-208">Cette variable d’environnement est lue par l’application, et les informations d’identification qu’elle contient sont analysées.</span><span class="sxs-lookup"><span data-stu-id="ccb27-208">This environment variable is read by the application, and the credentials within it are parsed.</span></span> <span data-ttu-id="ccb27-209">Si vous avez besoin de sélectionner le fichier d’autorisation lors de l’exécution, manipulez l’environnement du programme à l’aide de la fonction [os.Setenv](https://golang.org/pkg/os/#Setenv).</span><span class="sxs-lookup"><span data-stu-id="ccb27-209">If you need to select the authorization file at runtime, manipulate the program's environment using the [os.Setenv](https://golang.org/pkg/os/#Setenv) function.</span></span>

<span data-ttu-id="ccb27-210">Pour charger les informations d’authentification, appelez la fonction [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile).</span><span class="sxs-lookup"><span data-stu-id="ccb27-210">To load the authentication information, call the [NewAuthorizerFromFile](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewAuthorizerFromFile) function.</span></span> <span data-ttu-id="ccb27-211">Contrairement à l’autorisation basée sur l’environnement, l’autorisation basée sur un fichier nécessite un point de terminaison de ressource.</span><span class="sxs-lookup"><span data-stu-id="ccb27-211">Unlike environment-based authorization, file-based authorization requires a resource endpoint.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
authorizer, err := NewAuthorizerFromFile(azure.PublicCloud.ResourceManagerEndpoint)
```

<span data-ttu-id="ccb27-212">Pour plus d’informations sur l’utilisation des principaux de service et la gestion de leurs autorisations d’accès, consultez [Créer un principal de service avec l’interface de ligne de commande Azure 2.0].</span><span class="sxs-lookup"><span data-stu-id="ccb27-212">For more on using service principals and managing their access permissions, see [Create a service principal with Azure CLI].</span></span>

## <a name="use-device-token-authentication"></a><span data-ttu-id="ccb27-213">Utiliser l’authentification par jeton d’appareil</span><span class="sxs-lookup"><span data-stu-id="ccb27-213">Use device token authentication</span></span>

<span data-ttu-id="ccb27-214">Si vous souhaitez que les utilisateurs se connectent de manière interactive, l’authentification par jeton d’appareil est la meilleure option.</span><span class="sxs-lookup"><span data-stu-id="ccb27-214">If you want users to sign in interactively, the best way is through device token authentication.</span></span> <span data-ttu-id="ccb27-215">Ce flux d’authentification passe à l’utilisateur un jeton à coller dans un site de connexion Microsoft, sur lequel il peut ensuite s’authentifier avec un compte Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="ccb27-215">This authentication flow passes the user a token to paste into a Microsoft sign-in site, where they then authenticate with an Azure Active Directory (AAD) account.</span></span> <span data-ttu-id="ccb27-216">Cette méthode d’authentification prend en charge les comptes pour lesquels l’authentification multifacteur est activée, contrairement à l’authentification par nom d’utilisateur/mot de passe standard.</span><span class="sxs-lookup"><span data-stu-id="ccb27-216">This authentication method supports accounts that have multi-factor authentication enabled, unlike standard username/password authentication.</span></span>

<span data-ttu-id="ccb27-217">Pour utiliser l’authentification par jeton d’appareil, vous devez créer un agent d’autorisation [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) avec la fonction [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig).</span><span class="sxs-lookup"><span data-stu-id="ccb27-217">To use device token authentication, create a [DeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig) authorizer with the [NewDeviceFlowConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#NewDeviceFlowConfig) function.</span></span> <span data-ttu-id="ccb27-218">Appelez l’[Agent d’autorisation](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) sur l’objet résultant pour démarrer le processus d’authentification.</span><span class="sxs-lookup"><span data-stu-id="ccb27-218">Call [Authorizer](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig.Authorizer) on the resulting object to start the authentication process.</span></span> <span data-ttu-id="ccb27-219">L’authentification par flux d’appareil bloque l’exécution du programme jusqu’à ce que le flux d’authentification soit entièrement terminé.</span><span class="sxs-lookup"><span data-stu-id="ccb27-219">Device flow authentication blocks program execution until the whole authentication flow is complete.</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
deviceConfig := auth.NewDeviceFlowConfig(applicationID, tenantID)
authorizer, err := deviceConfig.Authorizer()
```

## <a name="use-an-authentication-client"></a><span data-ttu-id="ccb27-220">Utiliser un client d’authentification</span><span class="sxs-lookup"><span data-stu-id="ccb27-220">Use an authentication client</span></span>

<span data-ttu-id="ccb27-221">Si vous avez besoin d’un type d’authentification spécifique et que vous acceptez que votre programme s’occupe de charger les informations d’authentification de l’utilisateur, vous pouvez utiliser n’importe quel client qui est conforme à l’interface [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig).</span><span class="sxs-lookup"><span data-stu-id="ccb27-221">If you require a specific type of authentication and are willing to have your program do the work to load authentication information from the user, you can use any client that conforms to the [auth.AuthorizerConfig](https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#AuthorizerConfig) interface.</span></span> <span data-ttu-id="ccb27-222">Utilisez un type qui implémente cette interface quand :</span><span class="sxs-lookup"><span data-stu-id="ccb27-222">Use a type that implements this interface when you:</span></span>

* <span data-ttu-id="ccb27-223">vous écrivez un programme interactif ;</span><span class="sxs-lookup"><span data-stu-id="ccb27-223">Write an interactive program</span></span>
* <span data-ttu-id="ccb27-224">vous utilisez des fichiers config spécialisés ;</span><span class="sxs-lookup"><span data-stu-id="ccb27-224">Use specialized configuration files</span></span>
* <span data-ttu-id="ccb27-225">vous avez une exigence qui empêche l’utilisation d’une méthode d’authentification intégrée.</span><span class="sxs-lookup"><span data-stu-id="ccb27-225">Have a requirement that prevents using a built-in authentication method</span></span>

> [!WARNING]
> <span data-ttu-id="ccb27-226">Ne codez jamais les informations d’identification en dur dans une application.</span><span class="sxs-lookup"><span data-stu-id="ccb27-226">Never hard-code Azure credentials into an application.</span></span> <span data-ttu-id="ccb27-227">Placer des secrets dans un binaire d’application facilite leur extraction par un intrus, que l’application soit en cours d’exécution ou non.</span><span class="sxs-lookup"><span data-stu-id="ccb27-227">Putting secrets into an application binary makes it easier for an attacker to extract them, whether the application is running or not.</span></span> <span data-ttu-id="ccb27-228">Cela expose toutes les ressources Azure, pour lesquelles les informations d’identification sont autorisées, à des risques !</span><span class="sxs-lookup"><span data-stu-id="ccb27-228">This puts all Azure resources the credentials are authorized for at risk!</span></span>

<span data-ttu-id="ccb27-229">Le tableau suivant répertorie les types dans le Kit de développement logiciel (SDK) conformes à l’interface `AuthorizerConfig`.</span><span class="sxs-lookup"><span data-stu-id="ccb27-229">The following table lists the types in the SDK that conform to the `AuthorizerConfig` interface.</span></span>

| <span data-ttu-id="ccb27-230">Type d'authentification</span><span class="sxs-lookup"><span data-stu-id="ccb27-230">Authentication type</span></span> | <span data-ttu-id="ccb27-231">Type d’agent d’autorisation</span><span class="sxs-lookup"><span data-stu-id="ccb27-231">Authorizer type</span></span> |
|---------------------|-----------------------|
| <span data-ttu-id="ccb27-232">Authentification par certificat</span><span class="sxs-lookup"><span data-stu-id="ccb27-232">Certificate-based authentication</span></span> | <span data-ttu-id="ccb27-233">[ClientCertificateConfig]</span><span class="sxs-lookup"><span data-stu-id="ccb27-233">[ClientCertificateConfig]</span></span> |
| <span data-ttu-id="ccb27-234">Informations d'identification du client</span><span class="sxs-lookup"><span data-stu-id="ccb27-234">Client credentials</span></span> | <span data-ttu-id="ccb27-235">[ClientCredentialsConfig]</span><span class="sxs-lookup"><span data-stu-id="ccb27-235">[ClientCredentialsConfig]</span></span> |
| <span data-ttu-id="ccb27-236">Identité du service administré (MSI)</span><span class="sxs-lookup"><span data-stu-id="ccb27-236">Managed Service Identity (MSI)</span></span> | <span data-ttu-id="ccb27-237">[MSIConfig]</span><span class="sxs-lookup"><span data-stu-id="ccb27-237">[MSIConfig]</span></span> |
| <span data-ttu-id="ccb27-238">Nom d’utilisateur/mot de passe</span><span class="sxs-lookup"><span data-stu-id="ccb27-238">Username/password</span></span> | <span data-ttu-id="ccb27-239">[UsernamePasswordConfig]</span><span class="sxs-lookup"><span data-stu-id="ccb27-239">[UsernamePasswordConfig]</span></span> |

[ClientCertificateConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCertificateConfig
[ClientCredentialsConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#ClientCredentialsConfig
[MSIConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#MSIConfig
[DeviceFlowConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#DeviceFlowConfig
[UsernamePasswordConfig]: https://godoc.org/github.com/Azure/go-autorest/autorest/azure/auth#UsernamePasswordConfig

<span data-ttu-id="ccb27-244">Créez un authentificateur avec sa fonction `New` associée, puis appelez `Authorize` sur l’objet résultant pour vous authentifier.</span><span class="sxs-lookup"><span data-stu-id="ccb27-244">Create an authenticator with its associated `New` function, and then call `Authorize` on the resulting object to authenticate.</span></span> <span data-ttu-id="ccb27-245">Par exemple, pour l’authentification par certificat :</span><span class="sxs-lookup"><span data-stu-id="ccb27-245">For example, to use certificate-based authentication:</span></span>

```go
import "github.com/Azure/go-autorest/autorest/azure/auth"
certificateAuthorizer := auth.NewClientCertificateConfig(certificatePath, certificatePassword, clientID, tenantID)
authorizerToken, err := certificateAuthorizer.Authorize()
```
